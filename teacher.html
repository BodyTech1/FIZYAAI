<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Ù…Ù†ØµØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ù„Ù„ÙÙŠØ²ÙŠØ§Ø¡ ØªØ³Ø§Ø¹Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø¹Ù„Ù‰ ØªØ¹Ù„Ù… Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ø³Ù‡Ù„Ø© ÙˆÙ…Ù…ØªØ¹Ø©">
    <meta name="keywords" content="ÙÙŠØ²ÙŠØ§Ø¡, ØªØ¹Ù„ÙŠÙ…, Ù…Ù†ØµØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ©, Ø¯Ø±ÙˆØ³ ÙÙŠØ²ÙŠØ§Ø¡, Ø§Ù…ØªØ­Ø§Ù†Ø§Øª ÙÙŠØ²ÙŠØ§Ø¡, Ù…Ø°ÙƒØ±Ø§Øª ÙÙŠØ²ÙŠØ§Ø¡">
    <meta name="author" content="Ù…Ø³ØªØ± ÙŠØ§Ø³Ø± Ø¹Ù„ÙŠ">
    <meta property="og:title" content="ÙØ²ÙŠØ§Ø¦ÙŠ | Ù…Ù†ØµØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ù„Ù„ÙÙŠØ²ÙŠØ§Ø¡">
    <meta property="og:description" content="Ø§Ù†Ø¶Ù… Ø¥Ù„ÙŠÙ†Ø§ ÙÙŠ ÙØ²ÙŠØ§Ø¦ÙŠ ÙˆØªØ¹Ù„Ù… Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ø³Ù‡Ù„Ø© ÙˆÙ…Ù…ØªØ¹Ø© Ù…Ø¹ Ù…Ø³ØªØ± ÙŠØ§Ø³Ø± Ø¹Ù„ÙŠ">
    <meta property="og:image" content="ÙØ²ÙŠØ§Ø¦ÙŠ.png" >
    <meta property="og:type" content="website">
    <title>ÙØ²ÙŠØ§Ø¦ÙŠ | Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯Ø±Ø³</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="ÙØ²ÙŠØ§Ø¦ÙŠ.png">
</head>
<body>
    <!-- Navigation Bar -->
    <nav>
        <div class="navbar">
            <a href="index.html" class="logo">ğŸ”¥ ÙØ²ÙŠØ§Ø¦ÙŠ</a>
            <div>
                <a href="teacher.html">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</a>
                <a href="exams.html">Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª</a>
                <button onclick="toggleDarkMode()" id="dark-mode-btn">ğŸŒ™</button>
                <button onclick="logout()" id="logout-btn">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
            </div>
        </div>
    </nav>

    <!-- Teacher Dashboard Container -->
    <div class="container-large">
        <h1>ğŸ‘¨â€ğŸ« Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ù…Ù†ØµØ© ÙØ²ÙŠØ§Ø¦ÙŠ</h1>
        <p class="subtitle-text">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠÙ†</p>

        <!-- Statistics Cards -->
        

        <hr>

        <!-- Pending Requests Section -->
        <section>
            <h2 class="heading-warning">ğŸ“¥ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</h2>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>Ø§Ù„Ø§Ø³Ù…</th>
                            <th>Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„</th>
                            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨</th>
                            <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</th>
                        </tr>
                    </thead>
                    <tbody id="pending-table">
                    
                
                    </tbody>
                </table>
            </div>
        </section>

        <hr>

        <!-- Approved Students Section -->
        <section>
            <h2 class="heading-success">âœ… Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…Ù‚Ø¨ÙˆÙ„ÙŠÙ†</h2>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>Ø§Ù„Ø§Ø³Ù…</th>
                            <th>Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„</th>
                            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…</th>
                            <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                            <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</th>
                        </tr>
                    </thead>
                    <tbody id="approved-table">
                        
                        
                    </tbody>
                </table>
            </div>
        </section>

        <hr>

        <!-- Upload Exams Section -->
        <section>
            <h2 class="heading-primary">ğŸ“‹ Ø±ÙØ¹ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª</h2>
            <div class="form-container">
                <div class="form-grid">
                    <div>
                        <label for="exam-class" class="form-label">Ø§Ø®ØªØ± Ø§Ù„ØµÙ:</label>
                        <select id="exam-class" required>
                            <option value="">-- Ø§Ø®ØªØ± Ø§Ù„ØµÙ --</option>
                            <option value="1">Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ</option>
                            <option value="2">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ</option>
                            <option value="3">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ</option>
                        </select>
                    </div>
                    <div>
                        <label for="exam-name" class="form-label">Ø§Ø³Ù… Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†:</label>
                        <input type="text" id="exam-name" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù…ØªØ­Ø§Ù† Ø§Ù„ÙØµÙ„ Ø§Ù„Ø£ÙˆÙ„" required>
                    </div>
                    <div>
                        <label for="exam-file" class="form-label">Ø§Ø®ØªØ± ØµÙˆØ± Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† (Ø­ØªÙ‰ 4 ØµÙˆØ±):</label>
                        <input type="file" id="exam-file" accept="image/*" multiple required>
                    </div>
                </div>
                <textarea id="exam-description" placeholder="ğŸ“‘ ÙˆØµÙ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" class="form-textarea"></textarea>
                <button onclick="uploadExam()" class="btn btn-form">â¬†ï¸ Ø±ÙØ¹ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†</button>
                <p id="exam-message" class="message-text"></p>
            </div>
        </section>

        <hr>

        <!-- Exams Display Section -->
        <section>
            <h2 class="heading-primary">ğŸ“‹ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª Ø§Ù„Ù…Ø±ÙÙˆØ¹Ø©</h2>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>Ø§Ù„ØµÙˆØ±Ø©</th>
                            <th>Ø§Ø³Ù… Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†</th>
                            <th>Ø§Ù„ÙˆØµÙ</th>
                            <th>Ø§Ù„ØµÙ</th>
                            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø±ÙØ¹</th>
                            <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</th>
                        </tr>
                    </thead>
                    <tbody id="exams-table">
                        <tr>
                            <td colspan="5" class="empty-cell">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø§Ù…ØªØ­Ø§Ù†Ø§Øª</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <hr>

        <!-- Add Lesson Section -->
        <section>
            <h2 class="heading-primary">ğŸ“‘ Ø¥Ø¶Ø§ÙØ© Ø¯Ø±Ø³ Ø¬Ø¯ÙŠØ¯</h2>
            <div class="form-container">
                <div class="form-grid">
                    <input type="text" id="lessonTitle" placeholder="ğŸ“– Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯Ø±Ø³" required>
                    <select id="lessonClass" required>
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ</option>
                        <option value="1">Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ</option>
                        <option value="2">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ</option>
                        <option value="3">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ</option>
                    </select>
                </div>
                <textarea id="lessonDescription" placeholder="ğŸ“‘ ÙˆØµÙ Ø§Ù„Ø¯Ø±Ø³" class="form-textarea"></textarea>
                <input type="text" id="lessonLink" placeholder="ğŸ”— Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (YouTube)">
                <button onclick="addLesson()" class="btn btn-form">â• Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯Ø±Ø³</button>
                <p id="lessonMessage" class="message-text"></p>
            </div>
        </section>

        <hr>

        <!-- Lessons Management Section -->
        <section>
            <h2 class="heading-primary">ğŸ“š Ø§Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„Ù…Ø¶Ø§ÙØ©</h2>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯Ø±Ø³</th>
                            <th>Ø§Ù„ØµÙ</th>
                            <th>Ø§Ù„ÙˆØµÙ</th>
                            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø¶Ø§ÙØ©</th>
                            <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</th>
                        </tr>
                    </thead>
                    <tbody id="lessons-table">
                        
                    </tbody>
                </table>
            </div>
        </section>

        <hr>
     <!--   <section style="text-align: center; padding: 30px; background: linear-gradient(135deg, rgba(26, 35, 126, 0.05) 0%, rgba(255, 215, 0, 0.05) 100%); border-radius: 12px;">
            <h2>âš™ï¸ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø©</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px;">
                <button class="btn btn-secondary" onclick="alert('Ø³ÙŠØªÙ… ÙØªØ­ Ù…Ø­Ø±Ø± Ø§Ù„Ø¯Ø±ÙˆØ³')">ğŸ“ Ø¥Ø¶Ø§ÙØ© Ø¯Ø±Ø³ Ø¬Ø¯ÙŠØ¯</button>
                <button class="btn btn-secondary" onclick="alert('Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±')">ğŸ“Š Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</button>
                <button class="btn btn-secondary" onclick="alert('Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©')">ğŸ’¬ Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ø·Ù„Ø§Ø¨</button>
                <button class="btn btn-secondary" onclick="alert('Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª')">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
            </div>
        </section>
        -->
    </div>

    <!-- Footer -->
    <footer>
        <p>&copy; 2026 Ù…Ù†ØµØ© ÙØ²ÙŠØ§Ø¦ÙŠ - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</p>
        <p>
            <a href="#">Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</a> | 
            <a href="#">Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</a> | 
            <a href="#">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</a>
        </p>
    </footer>

    <script type="module" src="script.js"></script>
    <script>
        function initDarkMode() {
            const isDark = localStorage.getItem('darkMode') === 'true';
            const btn = document.getElementById('dark-mode-btn');
            if (isDark) {
                document.body.classList.add('dark-mode');
                if (btn) btn.textContent = 'â˜€ï¸';
            } else {
                document.body.classList.remove('dark-mode');
                if (btn) btn.textContent = 'ğŸŒ™';
            }
        }

        function toggleDarkMode() {
            const isDark = localStorage.getItem('darkMode') === 'true';
            const newState = !isDark;
            localStorage.setItem('darkMode', newState);
            initDarkMode();
        }

        function logout() {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ')) {
                localStorage.removeItem('isTeacher');
                location.href = 'index.html';
            }
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            initDarkMode();

            // Load lessons on page load
            const table = document.getElementById('lessons-table');
            let lessons = JSON.parse(localStorage.getItem('lessons')) || [];
            
            // Remove default row if lessons exist
            const rows = table.querySelectorAll('tr');
            if (lessons.length > 0 && rows.length === 1) {
                rows[0].remove();
            }
            
            // Add lessons to table
            lessons.forEach(lesson => {
                const classMap = {
                    '1': 'Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ',
                    '2': 'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ',
                    '3': 'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ'
                };
                
                const newRow = table.insertRow();
                newRow.setAttribute('data-id', lesson.id);
                newRow.innerHTML = `
                    <td>${lesson.title}</td>
                    <td>${classMap[lesson.class]}</td>
                    <td>${lesson.description}</td>
                    <td>${lesson.date}</td>
                    <td>
                        <button class="btn btn-warning btn-small" onclick="editLesson(this)">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
                        <button class="btn btn-danger btn-small" onclick="deleteLesson(this)">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                    </td>
                `;
            });
        });

        // Add lesson function
        function addLesson() {
            const title = document.getElementById('lessonTitle').value.trim();
            const classNum = document.getElementById('lessonClass').value.trim();
            const description = document.getElementById('lessonDescription').value.trim();
            const link = document.getElementById('lessonLink').value.trim();
            const messageDiv = document.getElementById('lessonMessage');

            console.log('Title:', title, 'Class:', classNum, 'Description:', description);

            // Validation
            if (!title || !classNum || !description) {
                messageDiv.innerHTML = '<span class="message error">âŒ ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© (Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„ØµÙ ÙˆØ§Ù„ÙˆØµÙ)</span>';
                messageDiv.style.color = '#721c24';
                return;
            }

            const classMap = {
                '1': 'Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ',
                '2': 'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ',
                '3': 'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ'
            };

            const today = new Date().toISOString().split('T')[0];
            
            // Create lesson object
            const lesson = {
                id: Date.now(),
                title: title,
                class: classNum,
                description: description,
                link: link,
                date: today
            };

            // Get existing lessons from localStorage
            let lessons = JSON.parse(localStorage.getItem('lessons')) || [];
            lessons.push(lesson);
            localStorage.setItem('lessons', JSON.stringify(lessons));

            // Add to table
            const table = document.getElementById('lessons-table');
            const newRow = table.insertRow();
            newRow.setAttribute('data-id', lesson.id);
            newRow.innerHTML = `
                <td>${title}</td>
                <td>${classMap[classNum]}</td>
                <td>${description}</td>
                <td>${today}</td>
                <td>
                    <button class="btn btn-warning btn-small" onclick="editLesson(this)">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
                    <button class="btn btn-danger btn-small" onclick="deleteLesson(this)">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                </td>
            `;

            // Clear form and show success message
            document.getElementById('lessonTitle').value = '';
            document.getElementById('lessonClass').value = '';
            document.getElementById('lessonDescription').value = '';
            document.getElementById('lessonLink').value = '';
            messageDiv.innerHTML = '<span class="message success">âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯Ø±Ø³ Ø¨Ù†Ø¬Ø§Ø­! Ø³ÙŠØ¸Ù‡Ø± ÙÙŠ ØµÙØ­Ø© Ø§Ù„ØµÙ Ù‚Ø±ÙŠØ¨Ø§Ù‹</span>';
            messageDiv.style.color = '#155724';

            // Clear success message after 3 seconds
            setTimeout(() => {
                messageDiv.innerHTML = '';
            }, 3000);
        }

        // Delete lesson function
        function deleteLesson(button) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¯Ø±Ø³ØŸ')) {
                const row = button.closest('tr');
                const id = row.getAttribute('data-id');
                
                // Remove from localStorage
                let lessons = JSON.parse(localStorage.getItem('lessons')) || [];
                lessons = lessons.filter(lesson => lesson.id != id);
                localStorage.setItem('lessons', JSON.stringify(lessons));
                
                row.remove();
                alert('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¯Ø±Ø³ Ø¨Ù†Ø¬Ø§Ø­');
            }
        }

        // Edit lesson function
        function editLesson(button) {
            const row = button.closest('tr');
            const cells = row.querySelectorAll('td');
            
            document.getElementById('lessonTitle').value = cells[0].textContent;
            document.getElementById('lessonClass').value = cells[1].textContent.includes('Ø§Ù„Ø£ÙˆÙ„') ? '1' : cells[1].textContent.includes('Ø§Ù„Ø«Ø§Ù†ÙŠ') ? '2' : '3';
            document.getElementById('lessonDescription').value = cells[2].textContent;
            
            window.scrollTo({top: document.querySelector('input#lessonTitle').offsetTop - 100, behavior: 'smooth'});
            document.getElementById('lessonTitle').focus();
            
            alert('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø±Ø³. Ø¹Ø¯Ù‘Ù„ Ù…Ø§ ØªØ±ÙŠØ¯Ù‡ Ø«Ù… Ø§Ø¶ØºØ· "Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯Ø±Ø³" Ù„Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª');
        }

        // Load lessons on page load
        // Utility: update dashboard counts
        function updateCounts() {
            // Lessons
            const lessons = JSON.parse(localStorage.getItem('lessons')) || [];
            const lessonsCountEl = document.getElementById('lessons-count');
            if (lessonsCountEl) lessonsCountEl.textContent = lessons.length;

            // Students: try localStorage first, else fallback to DOM
            let students = JSON.parse(localStorage.getItem('students')) || null;
            const pendingTable = document.getElementById('pending-table');
            const approvedTable = document.getElementById('approved-table');

            if (students) {
                const accepted = students.filter(s => s.status === 'approved').length;
                const pending = students.filter(s => s.status === 'pending').length;
                const acceptedEl = document.getElementById('accepted-count');
                const pendingEl = document.getElementById('pending-count');
                if (acceptedEl) acceptedEl.textContent = accepted;
                if (pendingEl) pendingEl.textContent = pending;
            } else {
                // Count rows in DOM tables
                const acceptedEl = document.getElementById('accepted-count');
                const pendingEl = document.getElementById('pending-count');
                const apRows = approvedTable ? approvedTable.querySelectorAll('tr').length : 0;
                const pdRows = pendingTable ? pendingTable.querySelectorAll('tr').length : 0;
                if (acceptedEl) acceptedEl.textContent = apRows;
                if (pendingEl) pendingEl.textContent = pdRows;
            }
        }

        // Accept / Reject handlers
        function acceptRequest(button) {
            const row = button.closest('tr');
            if (!row) return;
            const cells = row.querySelectorAll('td');
            const student = {
                name: cells[0].textContent.trim(),
                email: cells[1].textContent.trim(),
                date: new Date().toISOString().split('T')[0],
                status: 'approved'
            };

            // Save to localStorage students
            let students = JSON.parse(localStorage.getItem('students')) || [];
            students.push(student);
            localStorage.setItem('students', JSON.stringify(students));

            // Move row to approved table (clone and remove)
            const approvedTable = document.getElementById('approved-table');
            const newRow = approvedTable.insertRow();
            newRow.innerHTML = `
                <td>${student.name}</td>
                <td>${student.email}</td>
                <td>${student.date}</td>
                <td><span class="status-badge">Ù†Ø´Ø·</span></td>
                <td>
                    <button class="btn btn-warning btn-small" onclick="editStudent(this)">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
                    <button class="btn btn-danger btn-small" onclick="removeApproved(this)">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                </td>
            `;

            row.remove();
            updateCounts();
        }

        function rejectRequest(button) {
            const row = button.closest('tr');
            if (!row) return;
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ÙØ¶ Ø·Ù„Ø¨ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…ØŸ')) return;
            // Optionally store rejected students; for now just remove
            row.remove();
            updateCounts();
        }

        function removeApproved(button) {
            const row = button.closest('tr');
            if (!row) return;
            const email = row.querySelectorAll('td')[1].textContent.trim();
            // remove from localStorage students
            let students = JSON.parse(localStorage.getItem('students')) || [];
            students = students.filter(s => s.email !== email || s.status !== 'approved');
            localStorage.setItem('students', JSON.stringify(students));
            row.remove();
            updateCounts();
        }

        function editStudent(button) {
            alert('ÙØªØ­ Ù…Ø­Ø±Ø± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨ (Ù„ÙŠØ³ Ù…ÙØ¹Ù‘Ù„ Ø­Ø§Ù„ÙŠØ§Ù‹)');
        }

        // Exam upload and management
        function uploadExam() {
            const classNum = document.getElementById('exam-class').value;
            const examName = document.getElementById('exam-name').value.trim();
            const examDesc = document.getElementById('exam-description').value.trim();
            const files = document.getElementById('exam-file').files;
            const messageDiv = document.getElementById('exam-message');
            
            if (!classNum || !examName || files.length === 0) {
                messageDiv.innerHTML = '<span class="message error">âŒ Ø§Ø®ØªØ± Ø§Ù„ØµÙ ÙˆØ§Ø³Ù… Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† ÙˆØ§Ù„ØµÙˆØ±</span>';
                return;
            }
            
            if (files.length > 4) {
                messageDiv.innerHTML = '<span class="message error">âŒ Ù„Ø§ ØªØ³ØªØ·ÙŠØ¹ Ø±ÙØ¹ Ø£ÙƒØ«Ø± Ù…Ù† 4 ØµÙˆØ±</span>';
                return;
            }
            
            let imagesData = [];
            let loadedCount = 0;
            
            Array.from(files).forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    imagesData[index] = e.target.result;
                    loadedCount++;
                    
                    if (loadedCount === files.length) {
                        const exams = JSON.parse(localStorage.getItem('exams') || '[]');
                        exams.unshift({
                            id: Date.now().toString(),
                            class: parseInt(classNum),
                            name: examName,
                            description: examDesc,
                            images: imagesData,
                            date: new Date().toISOString().split('T')[0]
                        });
                        localStorage.setItem('exams', JSON.stringify(exams));
                        document.getElementById('exam-class').value = '';
                        document.getElementById('exam-name').value = '';
                        document.getElementById('exam-description').value = '';
                        document.getElementById('exam-file').value = '';
                        messageDiv.innerHTML = '<span class="message success">âœ… ØªÙ… Ø±ÙØ¹ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† Ø¨Ù†Ø¬Ø§Ø­ (' + files.length + ' ØµÙˆØ±Ø©)!</span>';
                        renderAllExams();
                        setTimeout(() => messageDiv.innerHTML = '', 3000);
                    }
                };
                reader.readAsDataURL(file);
            });
        }

        function renderAllExams() {
            const table = document.getElementById('exams-table');
            const exams = JSON.parse(localStorage.getItem('exams') || '[]');
            
            if (exams.length === 0) {
                table.innerHTML = '<tr><td colspan="6" class="empty-cell">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø§Ù…ØªØ­Ø§Ù†Ø§Øª</td></tr>';
                return;
            }
            
            table.innerHTML = '';
            const classMap = { '1': 'Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ', '2': 'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ', '3': 'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ' };
            
            exams.forEach(e => {
                const row = table.insertRow();
                
                // Build images display (support both old 'data' format and new 'images' format)
                const imagesList = e.images || (e.data ? [e.data] : []);
                let imagesHtml = '';
                if (imagesList.length > 0) {
                    imagesHtml = '<div class="images-flex">';
                    imagesList.forEach(img => {
                        imagesHtml += `<img src="${img}">`;
                    });
                    imagesHtml += '</div>';
                }
                
                row.innerHTML = `
                    <td class="table-center">${imagesHtml}</td>
                    <td>${e.name}</td>
                    <td>${e.description || '-'}</td>
                    <td>${classMap[e.class]}</td>
                    <td>${e.date}</td>
                    <td>
                        <button class="btn btn-danger btn-small" onclick="deleteExam('${e.id}')">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                    </td>
                `;
            });
        }

        function deleteExam(id) {
            if (!confirm('Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†ØŸ')) return;
            let exams = JSON.parse(localStorage.getItem('exams') || '[]');
            exams = exams.filter(e => e.id !== id);
            localStorage.setItem('exams', JSON.stringify(exams));
            renderAllExams();
        }

        // Load lessons and students on page load
        window.addEventListener('DOMContentLoaded', function() {
            const table = document.getElementById('lessons-table');
            let lessons = JSON.parse(localStorage.getItem('lessons')) || [];
            
            // Remove default row if lessons exist
            const rows = table.querySelectorAll('tr');
            if (lessons.length > 0 && rows.length === 1) {
                rows[0].remove();
            }
            
            // Add lessons to table
            lessons.forEach(lesson => {
                const classMap = {
                    '1': 'Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ',
                    '2': 'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ',
                    '3': 'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ'
                };
                
                const newRow = table.insertRow();
                newRow.setAttribute('data-id', lesson.id);
                newRow.innerHTML = `
                    <td>${lesson.title}</td>
                    <td>${classMap[lesson.class]}</td>
                    <td>${lesson.description}</td>
                    <td>${lesson.date}</td>
                    <td>
                        <button class="btn btn-warning btn-small" onclick="editLesson(this)">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
                        <button class="btn btn-danger btn-small" onclick="deleteLesson(this)">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                    </td>
                `;
            });

            // Ensure students data exists in localStorage. If not, migrate existing table rows (demo) into storage.
            if (localStorage.getItem('students') === null) {
                const migrated = [];
                const pdTable = document.getElementById('pending-table');
                const apTable = document.getElementById('approved-table');

                if (pdTable) {
                    const rows = pdTable.querySelectorAll('tr');
                    rows.forEach(r => {
                        const cells = r.querySelectorAll('td');
                        if (cells.length >= 3) {
                            migrated.push({
                                name: cells[0].textContent.trim(),
                                email: cells[1].textContent.trim(),
                                date: cells[2].textContent.trim() || new Date().toISOString().split('T')[0],
                                status: 'pending'
                            });
                        }
                    });
                }

                if (apTable) {
                    const rows = apTable.querySelectorAll('tr');
                    rows.forEach(r => {
                        const cells = r.querySelectorAll('td');
                        if (cells.length >= 3) {
                            migrated.push({
                                name: cells[0].textContent.trim(),
                                email: cells[1].textContent.trim(),
                                date: cells[2].textContent.trim() || new Date().toISOString().split('T')[0],
                                status: 'approved'
                            });
                        }
                    });
                }

                if (migrated.length > 0) {
                    localStorage.setItem('students', JSON.stringify(migrated));
                }
            }

            // Load students from localStorage into tables
            const students = JSON.parse(localStorage.getItem('students')) || null;
            if (students) {
                const pendingTable = document.getElementById('pending-table');
                const approvedTable = document.getElementById('approved-table');
                // clear existing demo rows
                if (pendingTable) pendingTable.innerHTML = '';
                if (approvedTable) approvedTable.innerHTML = '';

                students.forEach(s => {
                    if (s.status === 'pending') {
                        const r = pendingTable.insertRow();
                        r.innerHTML = `
                            <td>${s.name}</td>
                            <td>${s.email}</td>
                            <td>${s.date || ''}</td>
                            <td>
                                <button class="btn btn-success btn-small" onclick="acceptRequest(this)">âœ… Ù‚Ø¨ÙˆÙ„</button>
                                <button class="btn btn-danger btn-small" onclick="rejectRequest(this)">âŒ Ø±ÙØ¶</button>
                            </td>
                        `;
                    } else if (s.status === 'approved') {
                        const r = approvedTable.insertRow();
                        r.innerHTML = `
                            <td>${s.name}</td>
                            <td>${s.email}</td>
                            <td>${s.date || ''}</td>
                            <td><span class="status-badge">Ù†Ø´Ø·</span></td>
                            <td>
                                <button class="btn btn-warning btn-small" onclick="editStudent(this)">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
                                <button class="btn btn-danger btn-small" onclick="removeApproved(this)">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                            </td>
                        `;
                    }
                });
            }

            // Final counts update
            updateCounts();
            renderAllExams();
        });
    </script>

</body>
</html>